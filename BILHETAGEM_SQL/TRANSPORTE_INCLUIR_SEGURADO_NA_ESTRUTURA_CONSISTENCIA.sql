INSERT into APLTRANS.SEGURADO_PARALELO (ctl_vinc_sed, ctl_pesso, num_ramo_seg, cod_user, dhr_alter)
SELECT 
--	*,
	--p.NOM_PESSO ,
	--p.NOM_FANTS ,
	DISTINCT dv.CTL_VINCD AS ctl_vincd_sed, --EXIBIR NO GRID  E INSERT APLTRANS.SEGURADO_PARALELO
	s.CTL_clien_pps AS ctl_pesso, --EXIBIR NO GRID  E INSERT APLTRANS.SEGURADO_PARALELO
	s.NUM_RAMO_SEG AS num_ramo, --EXIBIR NO GRID  E INSERT APLTRANS.SEGURADO_PARALELO
	'RONALDO',
	now()
FROM
	DOC_VINCULADO dv
INNER JOIN CRP_PESSOA p ON
	p.COD_DOCUM_PRI = dv.COD_DOCUM
INNER JOIN SEG_PROPOSTA_SEGURO s ON
	s.CTL_CLIEN_PPS = p.CTL_PESSO
	AND s.TIP_PROPT = 1
	AND s.sit_tipo_prs IN (1, 2, 3, 6, 98)
	AND s.DAT_BAIXA_APO IS NOT NULL 
INNER JOIN SEG_PROPOSTA_LIMITE PL ON
	PL.NUM_PROPT = s.NUM_PROPT
	AND PL.TIP_LIMIT_SEG = 1
	AND PL.NUM_VERSA_PRS = s.NUM_VERSA_PRS
INNER JOIN CRP_RAMO_SEGURO r ON	
	r.NUM_RAMO_SEG = s.NUM_RAMO_SEG 
WHERE 1=1
	--CURRENT TIMESTAMP BETWEEN s.dat_inici_vig + 1 DAY AND s.dat_fim_vig
	AND s.dat_fim_vig >= '2024-11-01'
	AND s.NUM_PROPT NOT BETWEEN 55000000 AND 55999999
	AND s.NUM_PROPT NOT BETWEEN 999000000 AND 999999999
	AND s.NUM_RAMO_SEG = 1 -- PARAMETRO DO COMBO RAMO
	AND s.CTL_CLIEN_PPS IN (
1412824
)

COMMIT

/*DIFERENCA DA SEG_PROPOSTA_SEGURO COM A SEGURADO_PARALELO*/
SELECT DISTINCT S.CTL_CLIEN_PPS,  S.NUM_PROPT , S.NUM_APOLI , DAT_INICI_VIG , DAT_FIM_VIG , DAT_BAIXA_APO, S.NUM_RAMO_SEG, S.NUM_CIA_PAM
FROM
	DOC_VINCULADO dv
INNER JOIN CRP_PESSOA p ON
	p.COD_DOCUM_PRI = dv.COD_DOCUM
INNER JOIN SEG_PROPOSTA_SEGURO s ON
	s.CTL_CLIEN_PPS = p.CTL_PESSO
	AND s.TIP_PROPT = 1
	AND s.sit_tipo_prs IN (1, 2, 3, 6, 98)
	AND s.DAT_BAIXA_APO IS NOT NULL 
INNER JOIN SEG_PROPOSTA_LIMITE PL ON
	PL.NUM_PROPT = s.NUM_PROPT
	AND PL.TIP_LIMIT_SEG = 1
	AND PL.NUM_VERSA_PRS = s.NUM_VERSA_PRS
INNER JOIN CRP_RAMO_SEGURO r ON	
	r.NUM_RAMO_SEG = s.NUM_RAMO_SEG 
WHERE 1=1
	--CURRENT TIMESTAMP BETWEEN s.dat_inici_vig + 1 DAY AND s.dat_fim_vig
	AND s.dat_fim_vig >= '2024-11-01'
	AND s.NUM_PROPT NOT BETWEEN 55000000 AND 55999999
	AND s.NUM_PROPT NOT BETWEEN 999000000 AND 999999999
	AND s.NUM_RAMO_SEG = 1
	AND CTL_CLIEN_PPS NOT IN (
						  	SELECT ctl_pesso FROM SEGURADO_PARALELO WHERE NUM_RAMO_SEG = 1
						 )
ORDER BY CTL_CLIEN_PPS 










SELECT * FROM PAMAIS.CRP_RAMO_SEGURO 

SELECT DISTINCT NUM_RAMO_SEG  FROM SEGURADO_PARALELO 
WHERE CTL_PESSO = 1412824
SELECT * FROM seg_proposta_seguro
WHERE NUM_PROPT =24006991
WHERE CTL_CLIEN_PPS = 1202264
AND NUM_RAMO_SEG = 1
AND NUM_PROPT NOT BETWEEN 55000000 AND 55999999
AND NUM_PROPT NOT BETWEEN 999000000 AND 999999999
ORDER BY NUM_PROPT DESC 



SELECT * FROM AVERBACAO 
WHERE CTL_AVERB = 927253247

SELECT * FROM AVERBACAO_INDICE 
WHERE CTL_AVERB = 927253247

SELECT * FROM AVERBACAO
WHERE cod_user = 'JOB-PAMWEB'


INSERT into AVERBACAO_CONSISTENCIA (ctl_AVERB, CTL_USER, DHR_ALTER , SIT_AVERB , NUM_SEQ)

SELECT *--,15,CURRENT TIMESTAMP, 0,0  
FROM AVERBACAO_INDICE ai INNER JOIN AVERBACAO a ON ai.CTL_AVERB = a.CTL_AVERB 
WHERE ai.CTL_AVERB NOT IN (SELECT CTL_AVERB FROM AVERBACAO_CONSISTENCIA)
AND ai.SIT_AVERB = 0
ORDER BY a.DAT_EMBAR desc 

COMMIT


SELECT * FROM AVERBACAO_ERRO 
WHERE CTL_AVERB = 927252898


SELECT * FROM AVERBACAO_ERRO 
WHERE CTL_AVERB = 927256283

SELECT * FROM AVERBACAO_INDICE 
WHERE CTL_AVERB = 927256283
commit

SELECT * FROM AVERBACAO_CONSISTENCIA 
WHERE CTL_AVERB = 927258399

-- avb 927256283
-- valor 101.081,10


INSERT INTO APLTRANS.AVERBACAO_CONSISTENCIA (CTL_AVERB,CTL_USER,DHR_ALTER,SIT_AVERB,NUM_SEQ) VALUES (927252898,15,CURRENT TIMESTAMP, 0,0)

COMMIT


DELETE FROM SEGURADO_PARALELO 
WHERE CTL_PESSO IN(15171, 15141)

COMMIT

DESBLOQUEIO => SIT_TRANS =0
LIMPA DA AVERBAÇÃO ERRO


INSERT INTO AVERBACAO_ERRO VALUES(926965257,91,'RONALDO',CURRENT TIMESTAMP, 2)

COMMIT

SELECT * FROM AVERBACAO_INDICE 
WHERE CTL_AVERB IN  (926764853, 926923169, 926942783, 926965257)


SELECT * FROM AVERBACAO_CONSISTENCIA 
WHERE CTL_AVERB IN  (926764853, 926923169, 926942783, 926965257)


SELECT * FROM AVERBACAO_CONSISTENCIA 
WHERE CTL_AVERB IN  (926764853, 926923169, 926942783, 926965257)

SELECT * FROM AVERBACAO_ERRO 
WHERE CTL_AVERB IN  (926764853, 926923169, 926942783, 926965257)

DELETE FROM AVERBACAO_ERRO
WHERE CTL_AVERB IN  (924322820, 924869874, 925293558, 925503160,925666992,926014969)


COMMIT




SELECT * FROM CRP_CIA_SEGURADORA_PAMCARY 
WHERE num_cia_pam IN (69,226)

SELECT * FROM MOTORISTA_MOVTO 
WHERE CTL_MOTOT > 2006785

select * FROM APLTRANS.MOTORISTA_MOVTO  
WHERE upper(NOM_MOTOT) LIKE UPPER('%wanderlei de Resende Cunha%')


INSERT INTO MOTORISTA_MOVTO (CTL_MOTOT, TIP_DOCUM, COD_DOCUM_MOT, NOM_MOTOT, COD_USER, DHR_ALTER)
VALUES (NEXT VALUE FOR SQ_CTL_MOTOT, 2, 357655440880, 'PEDRO JOSÉ', 'emerson.goncalves', CURRENT TIMESTAMP);


SELECT * FROM AVERBACAO_MOTOT 
WHERE CTL_MOTOT IN 
(920936350,
923339888,
923339889,
923339890)


UPDATE AVERBACAO_MOTOT SET 
CTL_MOTOT = 2006789
WHERE CTL_MOTOT = 866322324


DELETE FROM MOTORISTA_MOVTO 
WHERE ctl_motot = 866322324

COMMIT


	       