

SELECT * FROM PAMAIS.V_CRP_EMBARCADOR vce 

/*LOCALIZA EMBARCADOR*/
SELECT
    t1.ctl_pesso AS ctl_pesso,
    t1.nom_pesso AS nom_embar,
    t1.nom_fants AS nom_fants,
    t1.tip_docum_pri AS tip_docum,
    t3.sig_tipo_doc AS sig_docum,
    t1.cod_docum_pri AS cod_docum,
    t1.dhr_alter AS dhr_alter
FROM
    PAMAIS.tcrp_pessoa t1,
    PAMAIS.tcrp_tipo_documento_pessoa t3
WHERE
    t1.tip_docum_pri = t3.tip_docum_pes
    AND t1.num_visao_pam = 2
    AND t1.NOM_PESSO LIKE '%LOG%'
ORDER BY COD_DOCUM_PRI    
   

/*IDENTIFICAR AVERBACOES PELA RAIZ DO CNPJ EMBARCADOR*/
SELECT VCE.NOM_EMBAR, * FROM DBPROD.TAVERBACAO_COMPLEM_ATM tca, PAMAIS.V_CRP_EMBARCADOR vce 
WHERE VCE.COD_DOCUM = TCA.COD_CNPJ_TOM 
AND COD_CNPJ_TOM LIKE '61068276%'C





SELECT DISTINCT rap.SEQ_NUMER_AVB 
	,p.SEQ_NUMER_PRS 
	,p.NUM_RAMO_SEG 
	,p.NUM_COBER_BAS 
	,p.TIP_AVERB 
	,rap.VLR_IS 
	,a.SEQ_LOCAL_ORI 
	,a.SEQ_LOCAL_DES 
	,a.SEQ_LOCAL_INT 
	,a.DHR_EMBAR 
	,a.IDT_CARGA_DSC 
	,a.IDT_VEICU 
	,a.STA_AVARI 
	,a.STA_FLUVI 
	,rap.NUM_ETAPA_AVB
	,a.STA_PERNA_DES 
	,a.STA_PERNA_ORI 
	,a.IDT_TARIF 
	,a.TIP_ISENC_SEG 
	,ai.NUM_AVERB_PAM
	,ai.SIT_TRANS 
	,ai.VLR_PAMTX 
	,ai.VLR_EMBAR_TOT
	,p.TIP_NEGOC 
	,p.NUM_ETAPA_PRS 
	,p.NUM_PERIO 
	,p.NUM_APOLI 
	,p.CTL_PEJUR_CIA 
	,p.CTL_PESSO_CLI 
	,p.DAT_FIM_VIG 
	,vpta.NUM_SEQUE_TAR 
	,vpta.NUM_TARIF 
	,vpta.DAT_INICI_VIG 
	,vpta.DAT_FIM_VIG 
	,vpta.VLR_TARIF 
FROM bilhet.TBIL_RELAC_AVERB_PROPT rap
, bilhet.TBIL_AVERBACAO a
, bilhet.TBIL_PROPOSTA p
, bilhet.TBIL_AVERBACAO_INDICE ai
, bilhet.V_BIL_PROPOSTA_TAXA_APLICAVEL vpta
WHERE rap.SEQ_NUMER_AVB = a.SEQ_NUMER_AVB 
AND p.SEQ_NUMER_PRS = rap.SEQ_NUMER_PRS 
AND ai.NUM_AVERB_PAM = a.NUM_AVERB_PAM 
AND vpta.SEQ_NUMER_PRS = p.SEQ_NUMER_PRS 
AND p.SEQ_NUMER_PRS = 505036
and ((vpta.DAT_INICI_VIG BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59' AND vpta.DAT_FIM_VIG BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')  
		OR (vpta.DAT_INICI_VIG BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59' AND vpta.DAT_FIM_VIG NOT BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')  
		OR (vpta.DAT_INICI_VIG NOT BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59' AND vpta.DAT_FIM_VIG BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')  
		OR (vpta.DAT_INICI_VIG < '2023-05-01 00:00:00' AND vpta.DAT_FIM_VIG > '2023-05-31 23:59:59') ) 
	AND vpta.NUM_TARIF IN (16,19,34,52,63,91)

SELECT
	tarifaperc0_.CTL_VIGEN_PEC AS CTL_VIGE1_15_0_,
	tarifaperc1_.NUM_TARIF_PEC AS NUM_TARI1_5_1_,
	tipotarifa2_.NUM_TARIF AS NUM_TARI1_11_2_,
	localidade3_.SEQ_NUMER_LOC AS SEQ_NUME1_16_3_,
	localidade4_.SEQ_NUMER_LOC AS SEQ_NUME1_16_4_,
	tarifaperc0_.NUM_TARIF_PEC AS NUM_TARI7_15_0_,
	tarifaperc0_.VLR_LIMIT_INF AS VLR_LIMI2_15_0_,
	tarifaperc0_.VLR_LIMIT_SPE AS VLR_LIMI3_15_0_,
	tarifaperc0_.DAT_FIM_VIG AS DAT_FIM_4_15_0_,
	tarifaperc0_.DAT_INICI_VIG AS DAT_INIC5_15_0_,
	tarifaperc0_.PCE_TARIF_PEC AS PCE_TARI6_15_0_,
	tarifaperc1_.SEQ_LOCAL_DES AS SEQ_LOCA2_5_1_,
	tarifaperc1_.SEQ_LOCAL_ORI AS SEQ_LOCA3_5_1_,
	tarifaperc1_.NUM_TARIF AS NUM_TARI4_5_1_,
	tipotarifa2_.PCE_MULTI_TAR AS PCE_MULT2_11_2_,
	localidade3_.COD_IDENT_PAD AS COD_IDEN2_16_3_,
	localidade3_.SEQ_LOCAL_PAI AS SEQ_LOCA6_16_3_,
	localidade3_.STA_NINFO AS STA_NINF3_16_3_,
	localidade3_.STA_URSUB AS STA_URSU4_16_3_,
	localidade3_.TIP_LOCAL AS TIP_LOCA5_16_3_,
	localidade4_.COD_IDENT_PAD AS COD_IDEN2_16_4_,
	localidade4_.SEQ_LOCAL_PAI AS SEQ_LOCA6_16_4_,
	localidade4_.STA_NINFO AS STA_NINF3_16_4_,
	localidade4_.STA_URSUB AS STA_URSU4_16_4_,
	localidade4_.TIP_LOCAL AS TIP_LOCA5_16_4_
FROM
	BILHET.TBIL_VIGEN_TARIFA_PERCURSO tarifaperc0_
INNER JOIN BILHET.TBIL_RELAC_TARIFA_PERCURSO tarifaperc1_ ON
	tarifaperc0_.NUM_TARIF_PEC = tarifaperc1_.NUM_TARIF_PEC
INNER JOIN BILHET.TBIL_TIPO_TARIFA_PROPOSTA tipotarifa2_ ON
	tarifaperc1_.NUM_TARIF = tipotarifa2_.NUM_TARIF
INNER JOIN BILHET.V_BIL_LOCALIDADE localidade3_ ON
	tarifaperc1_.SEQ_LOCAL_ORI = localidade3_.SEQ_NUMER_LOC
INNER JOIN BILHET.V_BIL_LOCALIDADE localidade4_ ON
	tarifaperc1_.SEQ_LOCAL_DES = localidade4_.SEQ_NUMER_LOC
WHERE
	((tarifaperc0_.DAT_INICI_VIG BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')
		AND (tarifaperc0_.DAT_FIM_VIG BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')
			OR (tarifaperc0_.DAT_INICI_VIG BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')
				AND (tarifaperc0_.DAT_FIM_VIG NOT BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')
					OR (tarifaperc0_.DAT_INICI_VIG NOT BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')
						AND (tarifaperc0_.DAT_FIM_VIG BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')
							OR tarifaperc0_.DAT_INICI_VIG<'2023-05-01 00:00:00' 
							AND tarifaperc0_.DAT_FIM_VIG> '2023-05-31 23:59:59')
	AND (tipotarifa2_.NUM_TARIF IN (63))	

SELECT
	DISTINCT vigenciata0_.NUM_SEQUE_VIG AS NUM_SEQU1_14_0_,
	tarifaprop1_.NUM_SEQUE_TAR AS NUM_SEQU1_6_1_,
	tipotarifa2_.NUM_TARIF AS NUM_TARI1_11_2_,
	vigenciata0_.NUM_SEQUE_TAR AS NUM_SEQU2_14_0_,
	vigenciata0_.VLR_TARIF AS VLR_TARI3_14_0_,
	vigenciata0_.STA_AGREGA_FILIAL AS STA_AGRE4_14_0_,
	vigenciata0_.DAT_FIM_VIG AS DAT_FIM_5_14_0_,
	vigenciata0_.DAT_INICI_VIG AS DAT_INIC6_14_0_,
	tarifaprop1_.COD_CNPJ_EMBARCADOR AS COD_CNPJ2_6_1_,
	tarifaprop1_.SEQ_NUMER_PRS AS SEQ_NUME3_6_1_,
	tarifaprop1_.NUM_TARIF AS NUM_TARI4_6_1_,
	tipotarifa2_.PCE_MULTI_TAR AS PCE_MULT2_11_2_
FROM
	BILHET.TBIL_VIGENCIA_TAXA_CLIENTE vigenciata0_
INNER JOIN BILHET.TBIL_RELAC_TAXA_PROPOSTA tarifaprop1_ ON
	vigenciata0_.NUM_SEQUE_TAR = tarifaprop1_.NUM_SEQUE_TAR
INNER JOIN BILHET.TBIL_TIPO_TARIFA_PROPOSTA tipotarifa2_ ON
	tarifaprop1_.NUM_TARIF = tipotarifa2_.NUM_TARIF
WHERE
	((vigenciata0_.DAT_INICI_VIG BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')
		AND (vigenciata0_.DAT_FIM_VIG BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')
			OR (vigenciata0_.DAT_INICI_VIG BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')
				AND (vigenciata0_.DAT_FIM_VIG NOT BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')
					OR (vigenciata0_.DAT_INICI_VIG NOT BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')
						AND (vigenciata0_.DAT_FIM_VIG BETWEEN '2023-05-01 00:00:00' AND '2023-05-31 23:59:59')
							OR vigenciata0_.DAT_INICI_VIG< '2023-05-01 00:00:00'
							AND vigenciata0_.DAT_FIM_VIG> '2023-05-31 23:59:59')
	AND (tipotarifa2_.NUM_TARIF IN (91))
	
	
SELECT * 
FROM bilhet.V_BIL_PROPOSTA_TAXA_APLICAVEL vpta
WHERE vpta.SEQ_NUMER_PRS =505036
and ((DAT_INICI_VIG BETWEEN '2023-07-01 00:00:00' AND '2023-07-31 23:59:59' AND DAT_FIM_VIG BETWEEN '2023-07-01 00:00:00' AND '2023-07-31 23:59:59')  
		OR (DAT_INICI_VIG BETWEEN '2023-07-01 00:00:00' AND '2023-07-31 23:59:59' AND DAT_FIM_VIG NOT BETWEEN '2023-07-01 00:00:00' AND '2023-07-31 23:59:59')  
		OR (DAT_INICI_VIG NOT BETWEEN '2023-07-01 00:00:00' AND '2023-07-31 23:59:59' AND DAT_FIM_VIG BETWEEN '2023-07-01 00:00:00' AND '2023-07-31 23:59:59')  
		OR (DAT_INICI_VIG < '2023-07-01 00:00:00' AND DAT_FIM_VIG > '2023-07-31 23:59:59') ) 
	AND NUM_TARIF IN (16,19,34,52,63,91)


SELECT f.SEQ_NUMER_FAT
, f.DHR_FATUR 
,vfp.NUM_PERIO_FAT 
,vfp.NUM_DIA_VEC 
,f.DAT_VENCI_FAT 
,f.NUM_MES_CPT 
,f.SIT_FATUR 
FROM bilhet.TBIL_FATURA f
, bilhet.TBIL_VENCIMENTO_FATURA_PROPT vfp
WHERE vfp.SEQ_NUMER_PRS = f.SEQ_NUMER_PRS 
AND f.SEQ_NUMER_PRS = 506386




SELECT * FROM 
bilhet.tbil_valor_soma_tipo_tarifa vstt
,bilhet.tbil_fatura f
WHERE vstt.seq_numer_fat = f.seq_numer_fat
AND f.seq_numer_prs = 506386
ORDER BY f.SEQ_NUMER_FAT DESc
 
502101 --anterior
507385 -- nova


SELECT * FROM bilhet.TBIL_FATURA tf 
WHERE SEQ_NUMER_PRS = 505036
ORDER BY SEQ_NUMER_FAT DESC 

SELECT * FROM bilhet.TBIL_VALOR_SOMA_TIPO_TARIFA tvstt 
WHERE SEQ_NUMER_FAT = 7000287308

SELECT * 
FROM bilhet.TBIL_RELAC_VISAO_PERCU_PADRA trvpp 
WHERE SEQ_NUMER_PRS = 505036


SELECT *  
FROM BILHET.TBIL_RELAC_VISAO_PROPT a
,bilhet.TBIL_VIGENCIA_TAXA_CLIENTE tvtc
,bilhet.TBIL_RELAC_TAXA_PROPOSTA trtp
WHERE a.NUM_SEQUE_VIG = tvtc.NUM_SEQUE_VIG
AND TRTP.NUM_SEQUE_TAR = TVTC.NUM_SEQUE_TAR 
--AND TRTP.NUM_TARIF = 91
AND a.SEQ_NUMER_PRS = 505036
ORDER BY A.DHR_ALTER DESC 


SELECT * FROM BILHET.TBIL_RELAC_AVERB_PROPT trap 
WHERE SEQ_NUMER_PRS = 505036
ORDER BY DHR_ALTER DESC 

SELECT * FROM bilhet.TBIL_VIGEN_TARIFA_PERCURSO tvtp 

SELECT * FROM bilhet.TBIL_VIGENCIA_TAXA_CLIENTE tvtc 

SELECT * FROM bilhet.TBIL_VIGEN_TARIFA_PERCURSO tvtp 

SELECT * FROM bilhet.TBIL_RELAC_TAXA_PROPOSTA trtp 








SELECT * FROM TBIL_AVERBACAO ta 
,TBIL_RELAC_AVERB_PROPT trap
, TBIL_AVERBACAO_INDICE tai 
WHERE ta.NUM_AVERB_PAM = tai.NUM_AVERB_PAM 
AND 

SELECT vtc.NUM_SEQUE_VIG 
,vtc.NUM_SEQUE_TAR 
,vtc.DAT_INICI_VIG 
,vtc.DAT_FIM_VIG 
,vtc.VLR_TARIF 
,rtp.NUM_TARIF 
,rtp.SEQ_NUMER_PRS 
,ttp.NUM_TARIF 
,ttp.NOM_TARIF 
,ttp.NOM_APELI_TAR 
,ttp.PCE_MULTI_TAR 
FROM bilhet.TBIL_VIGENCIA_TAXA_CLIENTE vtc --AGREGA FILIAL
,bilhet.TBIL_RELAC_TAXA_PROPOSTA rtp
,bilhet.TBIL_TIPO_TARIFA_PROPOSTA ttp
WHERE rtp.NUM_SEQUE_TAR = vtc.NUM_SEQUE_TAR 
AND ttp.NUM_TARIF = rtp.NUM_TARIF  
AND rtp.SEQ_NUMER_PRS = 505036

SELECT * FROM BILHET.TBIL_AVERBACAO ta 
SELECT * FROM bilhet.TBIL_AVERBACAO_INDICE tai 
SELECT * FROM DBPROD.AVERBACAO

SELECT * FROM bilhet.TBIL_TIPO_TARIFA_PROPOSTA
SELECT * FROM bilhet.TBIL_RELAC_TAXA_PROPOSTA
SELECT * FROM bilhet.TBIL_VIGENCIA_TAXA_CLIENTE

SELECT * FROM bilhet.TBIL_RELAC_VISAO_PERCU_PADRA trvpp 
WHERE SEQ_NUMER_PRS = 505036


SELECT (SELECT nom_pesso FROM pamais.tcrp_pessoa WHERE cod_docum_pri = ta.COD_CNPJ_TOMADOR), * FROM BILHET.TBIL_RELAC_AVERB_PROPT trap, bilhet.TBIL_AVERBACAO ta 
WHERE ta.SEQ_NUMER_AVB = TRAP.SEQ_NUMER_AVB 
AND trap.SEQ_NUMER_PRS = 505036
AND ta.DHR_AVERB BETWEEN '2023-04-01 00:00:00' AND '2023-05-31 23:59:59'

SELECT * FROM BILHET.TBIL_RELAC_VISAO_PROPT trvp  
WHERE SEQ_NUMER_AVB IN (
1145104332,
1143605608,
1143605609,
1143605610,
1143605611,
1143605612,
1143605613,
1143605614,
1143605615,
1143605616,
1143605617,
1143605618,
1143605619,
1143605620,
1143605621,
1143605622,
1143605623,
1143605624,
1143605625,
1143605626,
1143605627,
1143605628,
1143605629,
1143605630,
1143605631,
1143605632,
1143605633,
1143605634,
1143605635,
1143605636,
1143605637,
1144718581
)


SELECT * FROM BILHET.TBIL_VIGENCIA_TAXA_CLIENTE tvtc 
WHERE NUM_SEQUE_VIG = 1214973


SELECT * FROM gedad.TDAD_PROCS_PROPT_BILHE tppb 
WHERE CTL_CONTR_TAF = 25890798

SELECT * FROM GEDAD.TDAD_CONTR_TAREFA_VALIDACAO tctv  
WHERE NUM_TAREF_VAL = 87
AND CTL_CONTR_TAF = 25890798


SELECT * FROM GEDAD.TDAD_SITUA_CONTR_VALIDACAO tscv 

SELECT * FROM BILHET.TBIL_TIPO_TARIFA_PROPOSTA tttp 

SELECT tttp.NOM_APELI_PRE, * FROM BILHET.TBIL_VALOR_SOMA_TIPO_TARIFA tvstt, BILHET.TBIL_TIPO_TARIFA_PROPOSTA tttp  
WHERE tvstt.NUM_TARIF = tttp.NUM_TARIF 
AND TTTP.NUM_TARIF = 90
AND tvstt.SEQ_NUMER_FAT = 67999978794



SELECT * FROM bilhet.V_BIL_MOEDA vbm 