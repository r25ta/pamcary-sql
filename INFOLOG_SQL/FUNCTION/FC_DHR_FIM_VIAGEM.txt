CREATE OR REPLACE
FUNCTION FC_DHR_FIM_VIAGEM (PCTL_VIA NUMBER)
RETURN DATE
AS
CURSOR
 FV IS
 SELECT dhr_efeti_rea AS dhr_viage_ter
   FROM SUPERVISOR.ROTEIRO_MOTORISTA
  WHERE sit_fase_rea IN ( 'R', 'T' )
    AND ctl_parad = 12
    AND ctl_plvia = PCTL_VIA;
 FVR FV%ROWTYPE;
BEGIN
 OPEN FV;
 FETCH FV INTO FVR;
 IF FV%NOTFOUND THEN
    RETURN(NULL);
 END IF;
 CLOSE FV;
 RETURN(FVR.dhr_viage_ter);
END;
/
