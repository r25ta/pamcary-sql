CREATE OR REPLACE
FUNCTION FC_PLACA_CARRETA(PCTL_VIA NUMBER)
RETURN VARCHAR2
AS
CURSOR
 PLACA IS
 SELECT V.num_placa
   FROM SUPERVISOR.VEICULO V, SUPERVISOR.VEICULO_PLANO_VIAGEM VPL,
        SUPERVISOR.MODELO_VEICULO ModV, SUPERVISOR.GENERO_VEICULO GV
  WHERE VPL.ctl_veicu = V.ctl_veicu
    AND V.ctl_model = ModV.ctl_model
    AND ModV.ctl_gener = GV.ctl_gener
    AND GV.ctl_veicu_tip = 4
    AND VPL.ctl_plvia = PCTL_VIA;
 RPL PLACA%ROWTYPE;
BEGIN
 OPEN PLACA;
 FETCH PLACA INTO RPL;
 IF PLACA%NOTFOUND THEN
    RETURN(NULL);
 END IF;
 CLOSE PLACA;
 RETURN(RPL.num_placa);
END;
/
