CREATE OR REPLACE
FUNCTION FC_QTD_PARADA_REA(PNUM_ID NUMBER, PDHR_INI DATE, PDHR_TER DATE)
RETURN NUMBER
AS
CURSOR
REA IS
    SELECT num_mct, COUNT(*) as Qtd_real
    FROM MCT_MACRO
    WHERE num_mct = PNUM_ID
    AND num_macro in (52,57)
    AND dhr_event BETWEEN PDHR_INI AND PDHR_TER
    GROUP BY num_mct;          
FREA REA%ROWTYPE;
BEGIN
 OPEN REA;
 FETCH REA INTO FREA;
 IF REA%NOTFOUND THEN
    RETURN(NULL);
 END IF;
 CLOSE REA;
 RETURN(FREA.Qtd_real);
END;


