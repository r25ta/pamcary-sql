CREATE OR REPLACE
FUNCTION FC_QTD_PRV(PCTL_VIA NUMBER)
RETURN NUMBER
AS
CURSOR
 PRV IS
     SELECT ctl_plvia, count(*) as qtd_prev
       FROM ROTEIRO_MOTORISTA
      WHERE ctl_plvia = PCTL_VIA
        AND ctl_parad NOT IN ( 5, 6, 7, 8, 14 )
      GROUP BY ctl_plvia;
 FPRV PRV%ROWTYPE;
BEGIN
 OPEN PRV;
 FETCH PRV INTO FPRV;
 IF PRV%NOTFOUND THEN
    RETURN(NULL);
 END IF;
 CLOSE PRV;
 RETURN(FPRV.qtd_prev);
END;
/
