SELECT PV.ctl_plvia AS PLVIA, NVL(FC_ID_VEICULO(pv.ctl_plvia ), 0) AS ID_TERMINAL, PV.sit_plvia AS SIT_PLVIA, pv.tip_rastr As TIP_RASTR, (DECODE(PV.tip_rastr,1,'SATELITE',2,'CARTAO',3,'TELEFONICO')) AS DES_RASTR, SPV.des_situa AS DES_SIT_PLVIA, PV.ctl_opera_tip AS TIP_OPER, TOP.des_opera_tip AS DES_TIP_OPER, NVL(pv.ctl_empre_equ,0) As PROVEDOR, MPV.ctl_motot, MO.nom_vincd as MOTORISTA, PV.ctl_trnsp As CTL_TRNSP, FC_VINCULADO_NOM_GUERR(pv.ctl_trnsp) AS TRANSPORTADORA, PV.ctl_remet As CTL_REMET, FC_VINCULADO_NOM_GUERR(pv.ctl_remet) AS REMET, PV.ctl_desti AS CTL_DESTI, FC_VINCULADO_NOM_GUERR(pv.ctl_desti) AS DESTI, PR.cod_praca AS COD_PRACA_DESTI, PR.des_praca AS DES_PRACA_DESTI, UF.sig_unfed AS SIG_UNFED_DESTI, to_char(PV.dhr_plvia_ter,'YYYY-MM-DD-HH24.MI.SS') AS TERMINO, to_char(PV.dhr_inclu,'YYYY-MM-DD-HH24.MI.SS') AS INCLUSAO FROM plano_viagem PV, tipo_operacao TOP, motorista_plano_viagem MPV, vinculado MO, situacao_plano_viagem SPV, endereco_vinculado EV, praca PR, unidade_federal UF WHERE PV.ctl_opera_tip
 = Top.ctl_opera_tip AND to_char(PV.dhr_inclu, 'yyyymmdd') BETWEEN '20030818' AND '20030917' AND PV.ctl_plvia = MPV.ctl_plvia AND MPV.ord_motot = 1 AND MPV.ctl_motot = MO.ctl_vincd AND PV.sit_plvia = SPV.sit_plvia AND pv.ctl_remet = ev.ctl_vincd(+) AND ev.cod_praca = pr.cod_praca(+) AND pr.cod_unfed = uf.cod_unfed(+)